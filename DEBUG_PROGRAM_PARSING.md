# Отладка парсинга программ

## Проблема

Бот не распознает программу тренировок, отправленную пользователем.

## Тестовая программа

```
ПН

Грудь

-сведение рук в тренажере (бабочка) 3 подхода

-жим в тренажере 3 подхода 12 повторений

Руки

-разгибание рук с верхним блоком 3*10-12

-сгибание рук со штангой стоя 3*10-12

ВТ

ЧТ

Спина

-тяга верхнего блока к поясу (пуловер) 2х10

-тяга верхнего блока к груди 3*10-12 25 кг / тяга в тренажере

-горизонтальная тяга в тренажере 3*10 по одной руке

Плечи

-жим вверх сидя с гантелями 3*10-12

-отведение рук с гантелями стоя 3*10-12

СБ

- экстензия с блином 2*15

- приседания в тренажере 2*8-10

-подъем таза вверх в тренажере (ягодичный мост) 2*12

- разведения ног в стороны в тренажере 3*12

- отведение ноги назад в тренажере 3*12
```

## Ожидаемый результат

Программа должна быть распознана как:
- **День 1**: Понедельник: Грудь
  - сведение рук в тренажере (бабочка) 3 подхода
  - жим в тренажере 3 подхода 12 повторений
  - разгибание рук с верхним блоком 3*10-12
  - сгибание рук со штангой стоя 3*10-12

- **День 2**: Четверг: Спина
  - тяга верхнего блока к поясу (пуловер) 2х10
  - тяга верхнего блока к груди 3*10-12 25 кг / тяга в тренажере
  - горизонтальная тяга в тренажере 3*10 по одной руке
  - жим вверх сидя с гантелями 3*10-12
  - отведение рук с гантелями стоя 3*10-12

- **День 3**: Суббота
  - экстензия с блином 2*15
  - приседания в тренажере 2*8-10
  - подъем таза вверх в тренажере (ягодичный мост) 2*12
  - разведения ног в стороны в тренажере 3*12
  - отведение ноги назад в тренажере 3*12

## Изменения в коде

1. **Улучшена функция `is_program_text()`**:
   - Теперь проверяет построчно наличие упражнений
   - Распознает строки, начинающиеся с дефиса и содержащие числа
   - Распознает различные форматы подходов: "3 подхода", "3*10-12", "2х10"

2. **Улучшена функция `_parse_free_format()`**:
   - Улучшено распознавание упражнений, начинающихся с дефиса
   - Улучшена обработка групп мышц после дней недели
   - Улучшена обработка подзаголовков групп мышц внутри дня

3. **Улучшена функция `_is_day_header()`**:
   - Распознает сокращения дней недели в верхнем регистре (ПН, ВТ, ЧТ, СБ)
   - Правильно обрабатывает дни без названия группы мышц

## Проверка

После деплоя на Railway:

1. Отправьте программу боту
2. Бот должен распознать программу и предложить сохранить
3. Проверьте, что все дни и упражнения распознаны правильно

## Если проблема сохраняется

1. Проверьте логи Railway на наличие ошибок
2. Проверьте, что функция `is_program_text()` возвращает `True`
3. Проверьте, что функция `parse_user_program()` возвращает правильную структуру
4. Добавьте логирование в функции парсинга для отладки

